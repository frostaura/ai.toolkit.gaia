# TaleWeaver Production Environment Configuration
# Copy this file to .env.prod and update with your actual production values
# NEVER commit .env.prod to version control!

# ============================================================================
# DOCKER IMAGES
# ============================================================================
BACKEND_IMAGE=ghcr.io/yourusername/taleweaver-backend:latest
FRONTEND_IMAGE=ghcr.io/yourusername/taleweaver-frontend:latest

# ============================================================================
# APPLICATION PORTS
# ============================================================================
BACKEND_PORT=5000
FRONTEND_PORT=3000

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
POSTGRES_USER=taleweaver_prod
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE
POSTGRES_DB=taleweaver_production
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Full connection string
DATABASE_CONNECTION_STRING=Host=postgres;Port=5432;Database=taleweaver_production;Username=taleweaver_prod;Password=CHANGE_ME_STRONG_PASSWORD_HERE;SSL Mode=Require;Trust Server Certificate=false

# ============================================================================
# REDIS CACHE
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_CONNECTION_STRING=redis:6379,abortConnect=false

# ============================================================================
# AI SERVICE ENDPOINTS (Internal Docker Network)
# ============================================================================
OLLAMA_ENDPOINT=http://ollama:11434
TTS_ENDPOINT=http://tts-engine:5002
IMAGE_ENGINE_ENDPOINT=http://image-engine:5003

# ============================================================================
# AI MODEL CONFIGURATION
# ============================================================================
OLLAMA_STORY_MODEL=llama3:8b-instruct
OLLAMA_OUTLINE_MODEL=phi3:mini-instruct
OLLAMA_METADATA_MODEL=phi3:mini-instruct

# ============================================================================
# SECURITY - JWT CONFIGURATION
# ============================================================================
# Generate a strong JWT secret: openssl rand -base64 64
JWT_SECRET=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64
JWT_ISSUER=taleweaver-production
JWT_AUDIENCE=taleweaver-api
JWT_ACCESS_TOKEN_EXPIRY_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRY_DAYS=7

# ============================================================================
# STRIPE PAYMENT INTEGRATION
# ============================================================================
# Production API keys from https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_live_YOUR_STRIPE_SECRET_KEY
STRIPE_PUBLISHABLE_KEY=pk_live_YOUR_STRIPE_PUBLISHABLE_KEY

# Webhook secret from https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_YOUR_WEBHOOK_SECRET

# ============================================================================
# WEB PUSH NOTIFICATIONS (VAPID)
# ============================================================================
# Generate VAPID keys: npx web-push generate-vapid-keys
VAPID_PUBLIC_KEY=YOUR_VAPID_PUBLIC_KEY
VAPID_PRIVATE_KEY=YOUR_VAPID_PRIVATE_KEY
VAPID_SUBJECT=mailto:admin@yourdomain.com

# ============================================================================
# FRONTEND CONFIGURATION
# ============================================================================
NEXT_PUBLIC_API_URL=https://api.yourdomain.com
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_YOUR_STRIPE_PUBLISHABLE_KEY
NEXT_PUBLIC_VAPID_PUBLIC_KEY=YOUR_VAPID_PUBLIC_KEY

# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=Warning
LOG_FILE_PATH=/app/logs
LOG_RETENTION_DAYS=30

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# ============================================================================
# SSL/TLS CONFIGURATION (for reverse proxy)
# ============================================================================
DOMAIN=yourdomain.com
LETSENCRYPT_EMAIL=admin@yourdomain.com

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=14
BACKUP_S3_BUCKET=taleweaver-backups
BACKUP_S3_REGION=us-east-1
BACKUP_S3_ACCESS_KEY=YOUR_S3_ACCESS_KEY
BACKUP_S3_SECRET_KEY=YOUR_S3_SECRET_KEY

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
ENABLE_METRICS=true
ENABLE_TRACING=true

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000

# ============================================================================
# GPU CONFIGURATION
# ============================================================================
ENABLE_GPU=true
NVIDIA_VISIBLE_DEVICES=all

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================
OLLAMA_NUM_PARALLEL=4
OLLAMA_MAX_LOADED_MODELS=2
MAX_REQUEST_SIZE_MB=50
REQUEST_TIMEOUT_SECONDS=300
